
Метод гидроксильного футпринтинга (hydroxil-radical footprinting, HRF) является мощным методом исследования структур комплексов нуклеиновых кислот и белков в растворе с разрешением до одного нуклеотида. Чтобы использовать весь количественный потенциал HRF, мы описываем протокол для количественной оценки данных HRF и интеграции этих данных с атомистическими структурными моделями. Наш протокол, HYDroxyl-Radical Footprinting Interpretation for DNA (HYDROID) позволяет - анализировать данные HRF, полученные с помощью гель-электрофореза, - оценивать теоретические профили расщепления ДНК, полученные из молекулярных моделей, - визуализировать и сравнивать экспериментальные и теоретические профили расщепления. HYDROID полагается на новые алгоритмы аппроксимации данных и надежные подходы к обработке молекулярных моделей. HYDROID реализован на Python и обладает как возможность вызова из скриптов, так графического интерфейса. Этапы протокола HYDROID включают извлечение профилей дорожек из изображений геля, количественную оценку частоты расщепления ДНК по каждому нуклеотиду, теоретическую оценку частоты расщепления ДНК из атомистических структурных моделей с последующим сравнением экспериментальных и теоретических результатов. Примеры сценариев для каждого шага анализа и интерпретации данных HRF представлены для нескольких нуклеосомных систем; их можно легко адаптировать для анализа пользовательских данных. В качестве входного сигнала для HYDROID требуются изображения электрофоретических гелей продуктов реакции расщепления ДНК гидроксильными радикалами в полиакриламидном геле. Также может использоваться молекулярная модель комплекса ДНК-белок. Протокол HYDROID можно использовать для количественной оценки HRF на сегментах ДНК до 100 нуклеотидов на изображение геля. Кроме того протокол можно применять для анализа комплексов РНК-белок и свободных молекул РНК или ДНК в растворе. По сравнению с другими методами, HYDROID уникален своей способностью одновременно интегрировать данные HRF с анализом атомистических структурных моделей. HYDROID находится в свободном доступе по адресу \url{https://github.com/ncbi/HYDROID}. Выполнение полного протокола занимает примерно $\sim$ 3 часа. Пользователи должны быть знакомы с интерфейсом командной строки, языком сценариев Python и форматами файлов PDB. Также доступен графический пользовательский интерфейс с базовыми функциями (HYDROID\_GUI).


\subsection{Введение}
    Структурная характеристика комплексов нуклеиновая кислота-белок с высокой точностью необходима для нашего понимания функционирования генома, включая регуляцию экспрессии генов, транскрипцию, репликацию и репарацию ДНК. Хотя рентгеновская кристаллография остается золотым стандартом для определения структурных характеристик на атомистическом уровне, эта методика является сложной и часто не дает результатов из-за проблем с кристаллизацией. Методы ДНК-футпринтинга традиционно использовались как грубые, но универсальные и простые способы исследования взаимодействий ДНК-белок \textit{in vitro} \cite{tullius_physical_1989} и \textit{in vivo} \cite{adilakshmi_hydroxyl_2006,song_dnase-seq_2010}. В этих методах используются различные химические или ферментные агенты (например, ДНКаза I и гидроксильные радикалы) для расщепления ДНК в позициях, подверженных воздействию растворителя. Расположение этих положений может быть впоследствии идентифицировано с помощью гель-электрофореза при условии, что нити ДНК помечены радиоактивными или флуоресцентными метками на одном конце. Точность ферментативного расщепления ДНК ограничена стерическими эффектами и эффектами, специфичными для последовательности. С другой стороны, HRF является мощным методом, так как расщепление гидроксильными радикалами не имеет эффектов специфичных для последовательности, и обеспечивают высокое разрешение (вплоть до одного нуклеотида) из-за их малых размеров (см. \cite{jain_footprinting_2008-1} для подробного описания метода HRF).
    
    Основная интерпретация данных HRF часто выполняется качественно путем изучения соответствующих изображений электрофореза в полиакриламидном геле (ПААГЭ) ДНК или профилей интенсивности полос геля, полученных из этих изображений. Однако такой подход обычно не приводит к прямой трехмерной структурной интерпретации данных. Чтобы раскрыть весь потенциал этих высококачественных экспериментальных данных, необходимо выполнить две задачи: 1) количественную оценка фактических частот расщепления ДНК для каждого положения нуклеотида из данных ПААГЭ и 2) оценку частот расщепления ДНК из соответствующих атомистических молекулярных моделей. Вместе эти два компонента анализа позволяют интерпретировать данные HRF на более продвинутом уровне и позволяют включать данные в конвейеры молекулярного моделирования (рис. \ref{fig:p5_1_f1}) \cite{armeev_modeling_2016}. Используя такой подход, атомистические структурные модели высокого разрешения комплексов ДНК-белок могут быть проверены и/или уточнены с использованием экспериментальных данных HRF.



\begin{figure} [H]
    \centering
    \includegraphics[width=\textwidth]{images/p5/part5_1_np/p5_1_f1.pdf}
    \caption[Футпринтинг комплексов ДНК-белок гидроксильными радикалами и структурная интерпретация экспериментальных данных.]{\textbf{Футпринтинг комплексов ДНК-белок гидроксильными радикалами и структурная интерпретация экспериментальных данных.} На схематической диаграмме изложены основные идеи использования HRF для выяснения структуры комплексов ДНК-белок. Вверху: комплексы ДНК-белок восстанавливаются на радиоактивно меченной ДНК и подвергаются расщеплению гидроксильными радикалами; гидроксильные радикалы расщепляют нити ДНК на участках, не защищенных белком, в режиме кинетики одиночных расщеплений (по одному разрезу на нить); Репертуар расщепленных фрагментов ДНК анализируется с помощью денатурирующего гель-электрофореза, и становятся очевидными положения в последовательности ДНК, защищенных белком. Внизу: атомистические структурные модели могут использоваться для прогнозирования профилей футпринтинга; частота расщепления зависит от доступности атомов водорода дезоксирибозы; сравнение предсказанных и экспериментальных результатов может быть использовано для уточнения или проверки структурных моделей.}
    \label{fig:p5_1_f1}
\end{figure}

\subsection{Разработка протокола}

    Теоретическая основа для количественной оценки экспериментальных данных футпринтинга гидроксильными радикалами была предложена ранее \cite{balasubramanian_dna_1998,shadle_quantitative_1997,das_safa_2005,bishop_map_2011}. Однако, столкнувшись с практической необходимостью структурной интерпретации данных HRF для комплексов ДНК-белок в наших недавних исследованиях \cite{shaytan_hydroxyl-radical_2017,xiao_molecular_2017}, мы поняли, что не существует простого протокола и программного обеспечения как для количественной оценки данных HRF, так и для анализа атомистической структуры. Ранее описанные подходы \cite{shadle_quantitative_1997,das_safa_2005}, которые использовались для количественной оценки результатов ПААГЭ или расчетов доступной для растворителя площади поверхности для анализа трехмерной структуры, утратили совместимость с современными компьютерными платформами или не имеют воспроизводимых примеров данных для их повторной реализации и проверки. Чтобы удовлетворить эту потребность, мы разработали свободно доступное программное обеспечение и здесь предоставляем пошаговые инструкции по его использованию.

    Мы представляем протокол и программный пакет HYDROID (HYDroxyl-Radical fOotprinting Interpretation for DNA). HYDROID обеспечивает: количественный анализ данных HRF с разрешением в один нуклеотид, оценку частот расщепления ДНК по кристаллическим структурам или атомистическим молекулярным моделям, сравнение и интеграцию этих подходов. HYDROID написан на Python и использует бесплатные кроссплатформенные компоненты ImageJ для анализа изображений \cite{schneider_nih_2012} и библиотеку FreeSASA для расчета площади поверхности \cite{mitternacht_freesasa_2016}. Кросс-платформенный и надежный характер структуры HYDROID поддерживается этими хорошо обслуживаемыми, регулярно обновляемыми и тщательно тестируемыми базовыми технологиями. Протокол HYDROID состоит из двух библиотек, HYDROIDexp (анализ и визуализация экспериментальных данных) и HYDROIDpred (анализ структуры) вместе с набором примеров и пошаговыми инструкциями. HYDROID количественно оценивает экспериментальные профили дорожек ПААГЭ с помощью аппроксимации данных с использованием различных функций и ограничений при проведении аппроксимации. Пакет оценивает теоретические профили частоты (интенсивности) расщепления ДНК на основе атомистических трехмерных структур путем вычисления доступной для растворителя площади поверхности атомов водорода дезоксирибозы. Чтобы ознакомиться с протоколом HYDROID, мы создали видеоурок по адресу \url{https://ncbi.github.io/HYDROID/docs/video.html}. Протокол успешно применялся в двух исследованиях \cite{shaytan_hydroxyl-radical_2017,xiao_molecular_2017}.

\subsection{Применение метода}

    HYDROID - это надежный, но гибкий инструмент для анализа и интерпретации экспериментов по футпринтингу ДНК. Он одновременно сочетает в себе функциональность для количественной оценки данных ПААГЭ продуктов футпринтинга (HYDROIDexp) и оценки профилей расщепления ДНК в ходе гидроксильного футпринтинга из экспериментальных структур или молекулярных моделей (HYDROIDpred).

    Ранее мы применили подход HYDROID для изучения центромерных нуклеосом дрожжей и их комплексов с белком CENP-C \cite{shaytan_hydroxyl-radical_2017,xiao_molecular_2017}. Высококачественный анализ экспериментальных данных HRF с помощью HYDROID позволил нам точно определить положение ДНК на октамере гистонов, построить атомистическую модель центромерной нуклеосомы, воссозданной на определенной последовательности ДНК, и идентифицировать сайты взаимодействий белка CENP-C с нуклеосомой.

    В этом разделе подход HYDROID был протестирован и подтвержден с использованием нескольких наборов экспериментальных данных по комплексам ДНК-белок. Мы проанализировали влияние различных параметров на производительность HYDROID и дали рекомендации относительно того, какие параметры следует использовать при анализе комплексов ДНК-белок. В разделе ``Экспериментальный дизайн'' представлены дополнительные сведения, соответствующие примеры и рекомендации.

    Основные функции модулей HYDROID можно легко адаптировать и использовать для более широкого спектра приложений. В частности, модуль HYDROIDexp сам по себе может применяться для анализа данных гель-электрофореза нуклеиновых кислот любого типа, обеспечивая точное количественное определение интенсивности полос. Алгоритмы аппроксимации полос, разработанные в HYDROIDexp, в целом могут быть адаптированы для анализа данных капиллярного электрофореза.

    Модуль HYDROIDpred в его нынешнем виде способен анализировать доступность атомов водорода рибозы/дезоксирибозы с использованием подхода вычисления поверхности доступной растворителю H-SASA для свободной ДНК или РНК или в комплексе с белками. Мы не проводили обширных испытаний подхода H-SASA для оценки профилей частоты расщепления в случаях, отличных от комплексов ДНК-белок. Однако другие исследования ранее показали, что оценка профилей H-SASA для определенных атомов водорода в нативной РНК или ДНК может быть аналогичным образом использована для оценки паттернов расщепления HRF \cite{bishop_map_2011,ingle_chemical_2014}. В таких случаях мы рекомендуем ознакомиться с указанными выше ссылками и указать в скрипте HYDROIDpred, какие атомы водорода следует учитывать для анализа. Учитывая важность метода HRF для анализа третичной структуры РНК и РНК-белковых комплексов \cite{costa_probing_2014,hampel_time-resolved_2001,nilsen_mapping_2014}, мы ожидаем, что части пакета HYDROID будут полезны для этой цели и потенциально могут быть включены в конвейеры предсказания структуры РНК \cite{ding_three-dimensional_2012,tian_rna_2016}.


\subsection{Сравнение с другими методами}

    Уникальной характеристикой HYDROID является интеграция количественной оценки экспериментальных данных HRF и анализа атомистической трехмерной структуры в одном пакете. Преимущества функциональности, предоставляемой отдельными компонентами HYDROID (HYDROIDexp и HYDROIDpred), обсуждаются ниже.
    
    Некоторые автономные программы были разработаны на протяжении многих лет для решения задач количественной оценки гелей в экспериментах HRF, такие как GelExplorer \cite{shadle_quantitative_1997} или SAFA \cite{das_safa_2005}. Однако одним препятствием при использовании этих программ в настоящее время является то, что они не обновлялись в течение некоторого времени и не совместимы с современными компьютерными системами. Дополнительные преимущества библиотеки HYDROIDexp включают возможность выбора гауссовой или лоренцевой формы полос и множество алгоритмов аппроксимации с ограничениями на вариации параметров. Библиотека HYDROIDexp также включает инструменты, совместимые с Python, для построения профилей вдоль последовательности ДНК. Это бесплатное программное обеспечение, которое можно повторно использовать в других проектах.

    Что касается теоретической оценки профилей расщепления ДНК из трехмерных структур, HYDROIDpred в настоящее время является единственным доступным решением. Он основан на вычислении доступности атомов водорода через библиотеку FreeSASA, которая является быстрой и бесплатной в использовании. HYDROIDprep расширяет ее, предоставляя для расчетов тщательно подобранные наборы атомных радиусов. Ранее сообщалось об альтернативном подходе (подход RADACK), который пытается учесть контролируемую диффузией природу реакции атаки гидроксильных радикалов и общую геометрию молекулы с помощью стохастического моделирования \cite{begusova_radack_2001}. Однако в настоящее время нет общедоступного программного обеспечения, реализующего подход RADACK.

\subsection{Преимущества и ограничения}

    Основным преимуществом HYDROID является его конструкция 2-в-1, предоставляющая пользователю возможность одновременно количественно оценивать экспериментальные данные HRF и сравнивать их с атомистическими структурными моделями комплекса белок-нуклеиновая кислота, если они доступны. Оба компонента HYDROID, реализующие эти функции, имеют свои преимущества. В частности, преимущества HYDROIDexp включают его кроссплатформенный характер (работает в Linux, Windows, MacOS) и одновременную реализацию ряда алгоритмов аппроксимации профиля HRF (формы полос Гаусса или Лоренца в сочетании с несколькими алгоритмами аппроксимации с ограничениями). Алгоритмы аппроксимации с ограничениями хорошо работают при деконволюции сигнала от частично перекрывающихся полос геля. Преимущества HYDROIDpred включают его бесплатную природу без каких-либо патентованных или лицензионных программных компонентов, а также тщательно отобранные и проверенные наборы параметров (радиус зонда, размеры атомов), которые можно использовать для получения значимых оценок профиля расщепления ДНК на основе молекулярных моделей. Алгоритм HYDROIDpred основан на оценке доступной для растворителя области атомов водорода дезоксирибозы. Этот подход не может напрямую объяснить кинетику диффузии гидроксильных радикалов (см. Раздел ``Схема эксперимента'' для дальнейшего обсуждения). Следовательно, следует проявлять осторожность при сравнении точных форм экспериментальных и теоретических профилей расщепления.

    Для подхода HYDROIDpred на вход должны быть поданы PDB-структуры с атомами водорода. Предлагаемый алгоритм добавления атомов водорода (шаг 23) в настоящее время работает только в Linux или Mac.


\subsection{Обзор протокола HYDROID}

    HYDROID состоит из протокола и программного пакета, написанного на языке Python, который вместе с другими компонентами (ImageJ и FreeSASA) представляет собой надежную основу для анализа и интерпретации экспериментальных данных футпринтинга гидроксильными радикалами ДНК-белковых комплексов. Протокол также может применяться для анализа комплексов РНК-белок, а также свободных молекул РНК/ДНК в растворе. Пакет программного обеспечения HYDROID можно легко установить в операционных системах Linux, Mac или Windows. Он состоит из двух дополнительных конвейеров (и соответствующих программных библиотек) HYDROIDexp и HYDROIDpred. Конвейер HYDROIDexp используется для анализа изображений геля ПААГЭ для получения значений частоты расщепления ДНК для каждой позиции на исследуемой последовательности ДНК (рис. \ref{fig:p5_1_f2}, вверху). Конвейер HYDROIDpred используется для выполнения теоретических расчетов частоты расщепления ДНК на основе трехмерной атомистической структуры или молекулярной модели комплекса ДНК-белок (рис. \ref{fig:p5_1_f2}, внизу). Расчеты частоты расщепления выполняются путем расчета доступной для растворителя площади поверхности атомов водорода дезоксирибозы (которые атакуются гидроксильными радикалами и вызывают расщепление ДНК) для каждого нуклеотида (профили H-SASA). Профили H-SASA позволяют оценить ожидаемую частоту расщепления ДНК. Сравнение и интегрирование экспериментальных и теоретических профилей можно в дальнейшем использовать для интерпретации экспериментальных данных и/или уточнения молекулярной модели. Основные программные функции, реализованные в пакете HYDROID, перечислены в таблице \ref{tab:p5_t1}. Они предназначены для запуска из сценария Python, а некоторые функции имеют интерактивный графический интерфейс пользователя. В пакете HYDROID полнофункциональные примеры данных HRF и анализа трехмерной структуры представлены в виде тщательно аннотированных скриптов Python. Эти примеры можно легко загрузить, и они служат в качестве изменяемых шаблонов для анализа пользовательских данных (см. ПРОЦЕДУРА и ОЖИДАЕМЫЕ РЕЗУЛЬТАТЫ). Ниже мы описываем методологию, лежащую в основе ключевых этапов структуры HYDROID. Видеоиллюстрации каждого этапа доступны по адресу \url{https://ncbi.github.io/HYDROID/docs/video.html}.

\subsection{Конвейер HYDROIDexp}
 Конвейер HYDROIDexp требует в качестве входных данных изображение геля ПААГЭ с дорожками для продуктов HRF одной из нитей ДНК и соседних дорожек с продуктами реакций секвенирования ДНК для той же цепи. Конвейер дает значения относительной частоты расщепления ДНК (также называемые значениями интенсивности расщепления ДНК) вдоль последовательности ДНК. Этот конвейер можно применять параллельно к нескольким образцам, которые были обработаны на одном и том же геле. Конвейер состоит из пяти этапов. См. Диаграмму рабочего процесса на рисунке \ref{fig:p5_1_f2}.


\begin{figure} [H]
    \centering
    \includegraphics[width=\textwidth]{images/p5/part5_1_np/p5_1_f2.pdf}
    \caption[Конвейеры данных в HYDROID]{Конвейеры данных в HYDROID. Схематическая диаграмма для анализа экспериментальных данных по футпринтингу гидроксильными радикалами (вверху, HYDROIDexp). Теоретическая оценка профилей расщепления ДНК по молекулярным структурам (внизу, HYDROIDpred). Шаги и этапы процедуры аннотированы на схеме. Конвейер HYDROIDexp состоит из пяти этапов (отмечены синим цветом): этап 1 - профили дорожек в виде файлов данных извлекаются из изображения ПААГЭ, этап 2 - положения полос/пиков назначаются полуавтоматически на профилях дорожек, этап 3 - соответствие между полосами геля и последовательностью ДНК устанавливается, этап 4 - математическая модель подбирается для описания формы профиля дорожки с помощью функций Гаусса или Лоренца, этап 5 - интенсивности отдельных полос (частоты расщепления ДНК) извлекаются из модели. Конвейер HYDROIDpred состоит из двух этапов: этап 1 - загружается файл PDB интересующей системы и добавление атомов водорода к атомистической структуре при необходимости, этап 2 - профили доступности ДНК рассчитываются путем оценки доступной для растворителя области атомов водорода дезоксирибозы (H-SASA). Наконец, можно сравнить наборы теоретических и экспериментальных данных.}
    \label{fig:p5_1_f2}
\end{figure}



    \emph{Этап 1: Извлечение профилей дорожек геля}. Экспериментальные профили дорожек извлекаются из изображения геля. Экспериментальный профиль интенсивности полосы геля (профиль полосы) в дальнейшем определяется как массив значений интенсивности на изображении геля вдоль указанной полосы гель-электрофореза (в направлении миграции ДНК по гелю). Функции HYDROID считывают данные экспериментального профиля гелевой дорожки, сохраненные в виде столбцов чисел в текстовых файлах. Для получения ``цифровых'' экспериментальных профилей дорожек из изображений гелей ПААГЭ мы предлагаем использовать программное обеспечение ImageJ \cite{schneider_nih_2012} с плагином Bio-Formats \cite{linkert_metadata_2010} везде, где это необходимо для открытия файлов определенных форматов изображений гелей. 
    %Во вставке 2 приведены подробные инструкции по извлечению профилей полос в совместимом текстовом файле табличного формата из изображения СТРАНИЦЫ с помощью ImageJ. 
    Чтобы HYDROID мог считывать данные из сгенерированного файла, необходимо указать отдельный текстовый файл конфигурации, в котором указываются имена дорожек и соответствующие имена столбцов в сгенерированном файле.
    %(см. Блок 3 для более подробной информации о форматах входных файлов для HYDROIDexp. ).

    \emph{Этап 2: Назначение отдельных полос/пиков на геле}. Положение отдельных полос геля идентифицируется на профиле полосы геля с помощью полуавтоматического интерактивного алгоритма. Для деконволюции профиля полосы в набор вкладов от отдельных полос, сначала нужно знать количество и приблизительное расположение полос на профиле дорожки. Каждая полоса обычно соответствует локальному пику на профиле дорожки. Полуавтоматический интерактивный алгоритм, реализованный в
     функции \textit{assign\_peaks\_interactive} в HYDROID, открывает графическое окно и позволяет пользователю изменять параметры процедуры поиска пиков до тех пор, пока все необходимые пики не будут правильно идентифицированы по оценке пользователя. Алгоритм поиска пиков основан на библиотеке PeakUtils Python.
      Алгоритм регулируется двумя параметрами: относительной известностью пиков (параметр пикового порога - будут обнаружены только пики с амплитудой выше порога) и минимальным расстоянием между пиками. Алгоритм поиска пиков разделяет профиль полосы на несколько сегментов и позволяет пользователю выбирать минимальное расстояние между пиками для самого левого и самого правого сегментов (параметры \textit{min\_dist\_left} и \textit{min\_dist\_right}); значения в промежуточных сегментах затем выводятся с использованием линейной интерполяции. Если некоторые полосы перекрываются до такой степени, что пики не могут быть идентифицированы на профиле полосы или интенсивность полосы очень мала, в HYDROID реализована опция интерполяции пиков, чтобы попытаться вывести их положения из известных положений и расстояний между соседними группами, которые более заметны. Наконец, положения пиков можно указать вручную в файле конфигурации.

    \emph{Этап 3: Привязка пиков HRF к последовательности ДНК}. Каждую полосу на дорожке геля HRF (которая эквивалентна пику на профиле дорожки HRF) можно отнести к определенному положению в последовательности ДНК путем сравнения дорожек геля HRF с дорожками с продуктами реакций секвенирования ДНК для тех же ДНК. В HYDROID функция \textit{call\_peaks\_interactive} позволяет интерактивно строить профиль дорожки HRF вместе с профилями реакций секвенирования ДНК и последовательностью ДНК. Визуально сравнивая их с последовательностью ДНК, пользователь может указать местоположение любого одиночного пика на профиле и его соответствующее положение на последовательности ДНК. Это позволяет установить соответствие между всеми полосами и положениями в последовательности ДНК.

    \emph{Этап 4: Аппроксимация профилей интенсивности дорожек.} Математические модели, описывающие распределение интенсивности каждой полосы с помощью функций Гаусса или Лоренца, подгоняются к данным профиля полосы с помощью функции \textit{fit\_peaks}. Эта процедура позволяет вам провести деконволюцию необработанного экспериментального профиля HRF на вклады отдельных полос геля, тем самым должным образом принимая во внимание такие эффекты, как частичное перекрытие сигналов полос и неравномерная ширина полосы вдоль полосы геля 
    %(см. Вставку 4 для математических деталей алгоритма). 
    Известно, что эта процедура подвержена от переобучению, если на алгоритм подгонки не накладываются дополнительные ограничения \cite{takamoto_semi-automated_2004}. В HYDROID реализован ряд различных вариантов подгонки с ограничениями, перечисленных в Таблице \ref{tab:p5_t2}. См. Раздел ``Проблемы при экспериментальной количественной оценке профилей HRF'' для обсуждения дополнительных деталей.

    Чтобы оценить качество подгонки экспериментального профиля полосы с помощью модели, HYDROID предоставляет несколько критериев оценки: RMSD - среднеквадратичное отклонение между экспериментальными и прогнозируемыми значениями модели, относительное RMSD - вариация последнего, где отклонение в каждой точке выражается как часть экспериментального значения, и коэффициент корреляции Пирсона между экспериментальными и прогнозируемыми значениями.

    Значения частоты расщепления ДНК (общие площади под пиками на профиле дорожек) оценивают методом нелинейной аппроксимации методом наименьших квадратов. Для каждого пика площадь рассчитывается под сегментом кривой, который включает этот пик. Сегмент определяется серединами между положением данного пика (положением его максимума) и положением пиков его соседей слева и справа. Относительные различия в значениях прокси-площади, определенных для экспериментального профиля дорожки, по сравнению с профилем подобранной модели, используются как оценки неопределенности и называются ``относительными ошибками площади пика''. Максимальная относительная ошибка площади пика среди всех пиков, а также среднеквадратическое значение (``RMSD относительной площади пика'') вычисляются в HYDROID.
    
    \emph{Этап 5: Расчет частоты расщепления ДНК.} Частота расщепления ДНК для каждой позиции на ДНК вычисляется как площадь под гауссианой/лоренцевой кривой, описывающей соответствующую полосу. Значения профиля частоты расщепления ДНК отображаются вдоль последовательности ДНК.
    
    \subsection{Конвейер HYDROIDpred}
     Теоретический расчет профилей расщепления ДНК с помощью HYDROID основан на анализе трехмерных атомистических структур комплексов белок-ДНК и оценке доступности атомов водорода дезоксирибозы для гидроксильных радикалов. Трехмерные координаты можно получить с помощью рентгеновской кристаллографии или молекулярного моделирования (моделирование по гомологии, интегративное моделирование, докинг и т. д.). Доступная для растворителя площадь поверхности атомов водорода дезоксирибозы рассчитывается для каждого нуклеотида в молекуле ДНК структурного комплекса, что приводит к двум профилям H-SASA, по одному для каждой цепи (в случае, если протокол применяется к РНК, это приведет к одному профилю H-SASA). Он дает оценочные значения относительной частоты расщепления ДНК. Конвейер состоит из трех основных этапов.
    
    \textit{\emph{Этап 1:}Приготовление атомистической модели комплекса ДНК-белок с известными положениями атомов водорода.} Важным шагом является определение положений атомов водорода, если они отсутствуют в исходной структуре. Небольшие различия в положениях атомов водорода (например, разные параметры длины для связей C-X) могут повлиять на величину оцененных профилей (см. Подробное обсуждение в разделе ``Проблемы оценки теоретических частотных профилей расщепления ДНК из атомистических структур''). Программа REDUCE \cite{word_asparagine_1999} из пакета AmberTools 17 \cite{case_amber_nodate} с расстояниями связей X-H, полученными из  положений ядер атомов, может использоваться при добавлении атомов водорода в рентгеновские структуры.
    
    \emph{Этап 2:} \textit{Оценка теоретической частоты расщепления ДНК.} Теоретические профили частоты расщепления ДНК оцениваются путем расчета доступной для растворителя площади поверхности атомов водорода дезоксирибозы (профили H-SASA) с помощью функции get\_DNA\_H\_SASA, которая использует библиотеку FreeSASA \cite{mitternacht_freesasa_2016}. Алгоритм Ли-Ричардса используется \cite{lee_interpretation_1971} в FreeSASA с точностью до 200 срезов на атом по умолчанию. Для расчета SASA могут применяться другие радиусы зонда, по умолчанию 1,4\AA. HYDROID реализует три набора атомных радиусов для расчетов H-SASA: a) радиусы FreeSASA по умолчанию, б) значения радиусов из силового поля CHARMM36 \cite{best_optimization_2012} и в) значения радиусов из силового поля AMBER ff10 (parm10) \cite{case_amber_nodate}. Последние два получены из параметров rmin ван-дер-Ваальса (расстояние/радиус, при котором энергия Леннарда-Джонса имеет минимум) соответствующих силовых полей. Затем выполняется визуализация рассчитанных профилей (см. Визуализация и сравнение данных ниже).
    
    
    \subsection{Визуализация и сравнение данных}
    
    Для визуализации и сравнения профиля частоты расщепления ДНК HYDROID включает модуль построения графиков (\textit{plot\_prof\_on\_seq}) на основе библиотеки Matplotlib \cite{hunter_matplotlib_2007}. Этот модуль может одновременно строить несколько профилей вместе с последовательностью ДНК и позволяет использовать несколько методов нормализации (для приведения профилей к одному масштабу). Реализованы некоторые тривиальные методы нормализации, такие как деление каждого профиля на его максимальное значение (``every\_method'') или деление обоих профилей на их максимальное общее значение (``together\_method''). Кроме того, ``метод подгонки'' выполняет линейную регрессию без свободного члена между значениями профиля и изменяет их масштаб максимизируя взаимное максимальное соответствие. Использование линейной регрессии без свободного члена соответствует физическому требованию, согласно которому позиции, недоступные для расщепления, должны иметь нулевые значения на обоих профилях.

    Кроме того, мы реализовали метод моделирования профилей полос геля и изображений геля из профилей частоты расщепления (функция \textit{simulate\_gel}). Эта функция полезна для изучения ожидаемой формы профилей гелевых полос (и, следовательно, разрешения профиля в конкретной интересующей области ДНК) и планирования экспериментов. Модель подвижности ДНК Огстона используется для моделирования подвижности ДНК в геле \cite{slater_dna_2001}.
    


\begin{table}[h!]
    \centering
    \begin{tabularx}{\textwidth}{|X|X|}
        \hline
        \multicolumn{2}{|l|}{\textbf{Библиотека HYDROIDexp}} \\
        \hline
        assign\_peaks\_interactive & Предоставляет интерактивный интерфейс для полуавтоматического алгоритма, используемого для определения положения пиков на профилях гелевых дорожек.\\
        \hline
        call\_peaks\_interactive & Предоставляет интерактивный интерфейс для назначения индивидуальных пиков относительно положения последовательности ДНК.\\
        \hline
        fit\_peaks & Основная функция, которая подгоняет математическую модель профиля гелевой дорожки и оценивает интенсивность расщепления ДНК.\\
        \hline
        plot\_prof\_on\_seq & Строит любой профиль данных по последовательности ДНК и позволяет нормализовать и подгонять два или более профилей.\\
        \hline
        simulate\_gel & Имитирует форму профиля полосы геля и выводит изображение полосы геля на основе профиля H-SASA.\\
        \hline
        \multicolumn{2}{l|}{\textbf{Библиотека HYDROIDpred}} \\
        \hline
        get\_DNA\_H\_SASA & Оценивает теоретические профили расщепления ДНК (профили H-SASA) по структуре ДНК-белка.\\
        \hline
    \end{tabularx}
    \caption{Основные функции HYDROID и их описание.}
    \label{tab:p5_t1}
\end{table}



\begin{table}[h!]
    \centering
    \begin{tabularx}{\textwidth}{|X|X|}
        \hline
        Тип ограничения (аббревиатура) & Описание \\
        \hline
        dSIGMA>=0 & Ширина пика $\sigma$ не должна уменьшаться с увеличением D, положения пика (то есть от начала геля до конца). Это значительно повышает стабильность решения и предотвращает переобучение. \\
        \hline
        SIGMA<2*dD & Ширина пика $\sigma$ не может превышать удвоенное расстояние между данным пиком/полосой и последующим пиком (dD). Подразумевает автоматически ``dSIGMA> = 0''. \\
        \hline
        SIGMA=k*D+b & Ширина пика $\sigma$ линейно связана с положением пика (D). Это эффективно устанавливает линейную зависимость между шириной полосы и ее подвижностью. \\
        \hline
        log(SIGMA)=P2(log(M)) & Логарифм ширины пика $\sigma$ пропорционален логарифму числа нуклеотидов в ДНК, M, (или ее молекулярной массе) через полином второй степени. Оптимальные коэффициенты полинома определяются при подгонке: $\sigma_i = e^{a*(log M_i)^2 +b* log M_i +c}$) \\
        \hline
        SAFA & Ограничения, реализованные в программе SAFA \cite{das_safa_2005}, ширина пика связана с положением соседних пиков через $\sigma_i = \sigma_0 + k * \frac{D_{i + 1}-D_i}{2}$\\
        \hline
    \end{tabularx}
    \caption{Список ограничений при подгонке моделей, доступные в HYDROID.}
    \label{tab:p5_t2}
\end{table}


\subsection{Планирование экспериментов}
    
    \subsubsection{Метод HRF и интерпретация данных}
     В методе HRF используются гидроксильные радикалы, образованные в результате реакции Фентона или облучения, для расщепления цепей ДНК в доступных для растворителя участках \cite{jain_footprinting_2008-1}. Химический процесс, лежащий в основе, следующий: гидроксильный радикал атакует атомы водорода дезоксирибозы, что приводит к отщеплению водорода и последующему расщеплению основной цепи (рис. \ref{fig:p5_1_f1}). Основными продуктами этого химического расщепления являются две цепи, оканчивающиеся 3$^\prime$ и 5$^\prime$ фосфатами, которые примыкают к атакованному нуклеотиду в исходной цепи ДНК. Анализ продуктов расщепления ДНК обычно проводят с использованием денатурирующего электрофореза в полиакриламидном геле (ПААГЭ) предварительно радиоактивно/флуоресцентно меченой цепи (нитей) ДНК. Обычно рекомендуется радиоактивное мечение 5$^\prime$-конца ДНК \cite{jain_footprinting_2008-1}. В пределах кинетики единичного попадания (один разрез на цепь ДНК) доступность каждого нуклеотида для атаки гидроксильных радикалов должна быть пропорциональна интенсивности соответствующей полосы геля. Отнесение каждой полосы к определенному положению в последовательности ДНК является важным этапом и выполняется путем получения продуктов различных реакций секвенирования ДНК (таких, как реакции Максама-Гилберта) на соседних полосах геля (рис. \ref{fig:p5_1_f2}).
    
    Во время экспериментов по гидроксильному футпринтингу нуклеотид подвергается атаке гидроксильных радикалов, а затем разрушается, давая соответствующий фрагмент ДНК, который на один нуклеотид короче, чем предполагаемый фрагмент ДНК, оканчивающийся фактически атакованным нуклеотидом. Положение в последовательности ДНК, указанное пользователем на этом этапе, должно соответствовать нуклеотиду, который фактически подвергается атаке гидроксильных радикалов (и разрушается). Этот факт вместе с природой используемых реакций секвенирования ДНК следует учитывать при отнесении пика профиля HRF к положению в последовательности ДНК. Реакции секвенирования Максама-Гилберта удобны в этом отношении, поскольку они дают продукты, которые также на один нуклеотид короче, чем предполагаемые фрагменты ДНК, оканчивающиеся атакованным нуклеотидом \cite{maxam_new_1977}.
    
    Количественная оценка фактических частот расщепления ДНК требует измерения интенсивности отдельных полос из профилей интенсивности полос геля. Необходимо учитывать частичное перекрытие полос и изменение их ширины \cite{brahmasandra_mobility_2001}. Для определения общей интенсивности каждой полосы ранее была предложена математическая модель, которая использовалась для моделирования профиля интенсивности полос геля \cite{shadle_quantitative_1997}. При таком подходе интенсивность сигнала каждой полосы описывалась колоколообразной функцией, а результирующий профиль моделировался как сумма колоколообразных функций. К настоящему времени было предложено несколько функций моделирования, включая функции Гаусса, Лоренца \cite{shadle_quantitative_1997}, упрощенную интегрированную функцию Вейбулла \cite{bamidis_improved_2010} и более сложные функции \cite{greenbaum_construction_2007}. Хотя функция Гаусса является моделью по умолчанию для описания расширения полосы из-за свободной диффузии молекул, следует также учитывать некоторые другие факторы (например, электрическое поле, градиенты температуры, неоднородности геля и т. д.). В частности, методы радиографической детекции сигнала с геля могут изменять исходный сигнал, делая в некоторых случаях более подходящей модель функции Лоренца \cite{berg_appendix_1997}. По нашему опыту, данные, полученные для гелей с использованием современных установок, хорошо соответствуют функциям Гаусса. Более того, переобучение (overfitting) - обычная проблема для этих типов задач, и ее можно решить, наложив дополнительные ограничения на решение \cite{takamoto_semi-automated_2004}.
    
    Качество изображения геля, которое используется для извлечения профилей полос геля, является важной характеристикой, которая может повлиять на качество количественной оценки результатов HRF. Для получения хороших результатов ожидается, что в интересующей области будет отчетливо видна лестница из электрофоретических полос, представляющих продукты расщепления ДНК, отличающийся длинной в один нуклеотид. Однако протокол HYDROID также может быть успешным при деконволюции профилей дорожек в регионах, где некоторые полосы плохо видны или имеют значительное перекрытие. В этом случае пользователь должен иметь возможность указать количество ожидаемых диапазонов и их приблизительное расположение. С этой целью можно использовать места полос на других дорожках геля.
    
    Вычислительное структурное моделирование комплексов ДНК-белок можно направлять и проверять с помощью методов футпринтинга ДНК с высоким разрешением. Существует острая необходимость в программном решении для выполнения этих задач и объединения экспериментальных данных с трехмерными структурными моделями. Ранее Balasubramanian et al. провели детальное исследование интенсивности разрыва цепи ДНК при атаке на различные атомы водорода дезоксирибозы \cite{balasubramanian_dna_1998}. Они обнаружили, что атомы H5$^\prime$ и H5$^\prime$$^\prime$ обладают самой высокой реакционной способностью, за ними следуют H4$^\prime$, H3$^\prime$, H2$^\prime$ + H2$^\prime$$^\prime$ и H1$^\prime$. Более того, было обнаружено, что реакционная способность атомов водорода хорошо коррелирует с их доступной для растворителя площадью поверхности (SASA), которую можно оценить с помощью рентгеновских структур или предсказать с помощью структурных моделей. Это открытие является основой для теоретической оценки частот расщепления ДНК по атомистическим структурам в HYDROID. Однако, как мы обсудим далее, надежная оценка SASA для атомов водорода в комплексе ДНК-белок требует тщательного выбора параметров, таких как атомные радиусы, радиус сферы зонда и детали алгоритмов размещения атомов водорода.
    
    \subsubsection{Количественная обработка экспериментального профиля HRF}
    Количественная оценка экспериментальных профилей дорожек HRF выполняется в HYDROID путем деконволюции формы экспериментального профиля как суммы гауссовых (или лоренцевых) функций с центрами в положениях полос. Подгонка модели без ограничений обычно приводит к физически неправильным решениям (хотя и с лучшими характеристиками согласия), часто видны явные нарушения в положениях и ширине колоколообразных кривых, соответствующих отдельным полосам (верхняя панель рис. \ref{fig:p5_1_f3}В, а также результирующая частота расщепления ДНК (рис. \ref{fig:p5_1_f4}). Чтобы решить эту проблему, в HYDROID реализовано несколько ограничений в алгоритмах аппроксимации (Таблица \ref{tab:p5_t1}). Наиболее гибким является алгоритм ``dSIGMA> = 0'', который не позволяет ширине функций Гаусса уменьшаться при переходе от начала геля к его концу. Это основано на физическом предположении, что расширение полосы (более высокие коэффициенты дисперсии) увеличивается вместе с подвижностью ДНК в полосе. Это ограничение делает подобранное решение качественным в большинстве случаев, налагая только минимальные ограничения (рисунок \ref{fig:p5_1_f3}). Однако всегда рекомендуется визуальный осмотр полученного решения. Среди методов аппроксимации с ограничениями алгоритм ``dSIGMA> = 0'' обычно обеспечивает наилучшее соответствие, если судить по характеристикам качества аппроксимации. Другие алгоритмы ограничений также обеспечивают разумные решения со значениями RMSD относительной площади пика менее 2\% и почти идентичными результирующими профилями частоты расщепления ДНК.
    
    Анализ деконволюции профиля гелевых дорожек в HYDROID может быть выполнен с использованием функций Гаусса или Лоренца для аппроксимации распределения интенсивности полос. Некоторые предыдущие исследования показали, что Лоренциан может лучше соответствовать данным электрофореза ДНК \cite{shadle_quantitative_1997}. Для наборов экспериментальных данных, используемых в этом исследовании, функция Гаусса давала лучший результат, чем функция Лоренца, хотя различия в качестве аппроксимации не превышали 2\%, оцененные с помощью относительного среднеквадратичного отклонения. Однако профили интенсивности расщепления ДНК имели заметную разницу: при использовании лоренциана максимальные интенсивности расщепления имели тенденцию быть выше, а минимальные интенсивности расщепления были ниже, чем те, которые получены с использованием функции Гаусса. Этот эффект может быть объяснен медленным затуханием хвостов лоренцевского распределения, что заставляет пики с более высокой интенсивностью вносить больший вклад в амплитуду сигнала в соседних полосах с низкой интенсивностью.
    
    В профилях дорожек ПААГЭ геля иногда могут отсутствовать легко идентифицируемые максимумы для определенных полос. Это может произойти из-за шума, низкой интенсивности некоторых полос или перекрытия полос. Пока пользователь может определить количество и приблизительное положение этих полос, алгоритмы деконволюции HYDROID могут надежно их количественно оценить. Рисунок \ref{fig:p5_1_f3} иллюстрирует это для левой части профиля геля, где некоторые полосы перекрываются. Количественная оценка профилей, полученных электрофорезом одних и тех же продуктов реакции на двух разных гелях, дала почти идентичные результаты (неопубликованные наблюдения).
    
    
    \subsubsection{Оценка теоретических частотных профилей расщепления ДНК из атомистических структур}
    Следуя идеям, приведенным в \cite{balasubramanian_dna_1998} HYDROID оценивает теоретические профили частоты расщепления ДНК гидроксильными радикалами путем вычисления доступной для растворителя площади поверхности (SASA) атомов водорода дезоксирибозы (называемой профилями H-SASA). В общем, тот же метод можно применять для расчета доступной для растворителя площади поверхности атомов водорода рибозы РНК. Чтобы понять влияние различных параметров на форму профилей H-SASA, мы взяли структуру нуклеосомы в качестве примера и рассчитали профили H-SASA с различными наборами параметров: радиус зонда, наборы атомных радиусов, методы добавления атомов водорода, вклады от разных атомов водорода. Интерактивные графики профилей H-SASA, рассчитанных с различными параметрами, доступны по адресу  \url{https://ncbi.github.io/HYDROID/examples/example1/results/nucl_H-SASA.html}. Зависимость профилей H-SASA от радиуса зонда довольно проста: зонды меньшего размера могут различать более мелкие детали окклюзии ДНК белком, но делают профиль менее гладким и более зависимым от локальной геометрии взаимодействий ДНК-белок. Радиус зонда 1,4 \AA{} является обычным выбором, но расчет профилей H-SASA с различными размерами зонда может быть полезным для характеристики взаимодействий ДНК-белок в различных масштабах.
    
    Профили H-SASA довольно существенно зависят от выбора наборов атомных радиусов (FreeSASA vs CHARMM36 vs AMBER10) и от алгоритма, используемого для добавления атомов водорода (их положения в рентгеновских структурах обычно не разрешаются). Методологически последовательный подход требует генерирования положений атомов водорода с использованием параметров топологии из того же силового поля молекулярной механики, которое используется для оценки атомных радиусов. Как показано ранее, профили H-SASA чувствительны к небольшим колебаниям в геометрии остова ДНК как из-за неточностей рентгеновской структуры, так и из-за деталей конформации ДНК \cite{shaytan_hydroxyl-radical_2017}. Чтобы решить эту проблему, можно использовать моделирование молекулярной динамики (МД) для релаксации рентгеновских структур и анализа их динамики.  Основной вклад в H-SASA вносят значения площади, доступной для растворителя от атомов H5$^\prime$, H5$^\prime$$^\prime$ и H4$^\prime$ (рис. \ref{fig:p5_1_f5}A). Если H-SASA рассчитывается только для атомов H5$^\prime$, H5$^\prime$$^\prime$ и H4$^\prime$, соответствие между профилями, рассчитанными на основе MD и исходных рентгеновских структур, хорошее (рис. \ref{fig:p5_1_f5}Б). В частности, положения минимумов H-SASA (нуклеотиды ДНК, защищенные белком) подтверждаются между профилями (включая профили МД H-SASA, рассчитанные со всеми рассматриваемыми атомами водорода дезоксирибозы). Следовательно, при использовании рентгеновских структур без МД-релаксации рекомендуется расчет профилей H-SASA на основе только атомов H5$^\prime$, H5$^\prime$$^\prime$ и H4$^\prime$.
    
    Различия в форме экспериментальных и теоретических профилей расщепления ДНК можно объяснить двумя фактами. Во-первых, поскольку эксперименты с HRF проводятся в растворе, динамический характер конформации ДНК и взаимодействий между ДНК и белком могут привести к усреднению экспериментального профиля. Такие эффекты невозможно учесть теоретически, если не рассматривать и не анализировать динамический ансамбль структур. Во-вторых, из-за контролируемой диффузией природы реакции атаки гидроксильных радикалов, общая геометрия молекулы, включая ширину бороздок ДНК, также может модулировать вероятность атаки \cite{bishop_map_2011,begusova_radack_2001,spotheim-maurizot_radiation_2011}. Профили H-SASA могут лишь частично улавливать такие эффекты. Следовательно, при сравнении теоретических и экспериментальных профилей акцент следует делать на сравнении положений нуклеотидов, которые максимально защищены от атаки гидроксильными радикалами. Эффекты контролируемые диффузией отсутствуют для позиций ДНК, полностью защищенных белком.
    
    \subsection{Примеры данных}
    
    Протокол HYDROID использует два набора экспериментальных данных (названные ``Пример 1'' и ``Пример 2'', доступные  в репозитории GitHub), чтобы проиллюстрировать работу HYDROID. Пример 1 содержит данные HRF для центромерных нуклеосом \textit{S. cerevisiae}, восстановленных на последовательности ДНК 601TA с 3$^\prime$-концами, меченными радиоактивно, а пример 2 содержит данные HRF нуклеосом \textit{G. gallus}, восстановленных на последовательности ДНК 601 с 5$^\prime$-концами, меченными радиоактивно. Детали эксперимента для первого и второго наборов можно найти в ссылках \cite{shaytan_hydroxyl-radical_2017,xiao_molecular_2017} и \cite{morozov_using_2009} соответственно.

    Оба набора экспериментальных данных снабжены набором скриптов Python, которые образуют конвейер для анализа данных с использованием HYDROID и ожидаемых результирующих файлов.

    Пример 1 также предоставляет файлы с трехмерными координатами - молекулярную модель центромерной нуклеосомы дрожжей с последовательностью ДНК 601TA \cite{cloutier_dna_2005} (которая недоступна в PDB), которая была построена посредством моделирования по гомологии (с использованием Modeller \cite{sali_comparative_1993} и 3DNA \cite{lu_3dna_2008}). Последовательности гистонов были получены из HistoneDB2.0 \cite{draizen_histonedb_2016} и из соответствующей рентгеновской структуры нуклеосомы \textit{X. laevis} (PDB 3LZ0), как описано ранее \cite{shaytan_hydroxyl-radical_2017}. Программа REDUCE \cite{word_asparagine_1999} из пакета AmberTools 17 \cite{case_amber_nodate} использовалась для генерации положений атомов водорода с расстояниями связей X-H, полученных из положений ядер и электронных облаков. Кроме того, был использован подход молекулярной динамики. Используя команду VMD psfgen с силовым полем CHARMM36 \cite{best_optimization_2012}, гидратированные структуры были сгенерированы с последующим моделированием минимизации, релаксации и молекулярной динамики, как описано в наших более ранних исследованиях \cite{shaytan_hydroxyl-radical_2017}.
    
    \subsubsection{Опыт, необходимый для реализации протокола.} Пользователи должны быть знакомы с интерфейсом командной строки в Linux, Mac или Windows. Базовые знания языка сценариев Python были бы полезны для изменения простых сценариев Python с помощью текстового редактора. Для HYDROIDpred полезна часть понимания протокола формата PDB-файла.

    Оболочка графического пользовательского интерфейса (GUI) доступна для основных функций HYDROIDexp как дополнительный модуль по адресу \url{https://github.com/intbio/HYDROID_GUI} для тех пользователей, которые предпочли бы использовать GUI-интерфейс.
    
    
    
\begin{figure} [H]
    \centering
    \includegraphics[width=\textwidth]{images/p5/part5_1_np/p5_1_f3.pdf}
    \caption[Количественная оценка изображения геля ПААГЭ путем подбора математической модели.]{Количественная оценка изображения геля ПААГЭ путем подбора математической модели. A) ПААГЭ изображение продуктов расщепления гидроксильными радикалами для одной цепи ДНК нуклеосомы. Направление миграции ДНК на изображении слева направо. Для получения этого изображения центромерные нуклеосомы  \textit{S. cerevisiae} воссоздали на хорошо позиционирующей последовательности ДНК 601TA с ДНК, радиоактивно меченной на 3'-конце. Расщепление ДНК, экстракция ДНК, ПААГЭ и получение радиоактивного сигнала выполнялись, как описано в \cite{shaytan_hydroxyl-radical_2017}. Б) Извлеченные профили дорожек аппроксимируются с помощью модели, которая представляет каждую полосу геля как функцию Гаусса, показаны результаты аппроксимации без и с ограничениями на параметры модели. Площадь под каждым гауссом представляет интенсивность полосы и, следовательно, частоту расщепления ДНК. В) Увеличенная версия графиков для левой части геля, выделенная синей линией на панели B. Неравномерности ширины и положения гауссианы для метода аппроксимации без ограничений хорошо видны. Экспериментальные и модельные кривые невозможно различить, потому что они почти перекрываются. Ось Y на графиках представляет значения интенсивности профиля.}
    \label{fig:p5_1_f3}
\end{figure}
    
    
    \subsection{Материалы}
    \subsubsection{Оборудование и данные}
    
    \textbullet \ Компьютер, работающий в среде Linux, Mac или Windows.
    \textbullet \ ПААГЭ изображения продуктов реакции HRF и продуктов реакции секвенирования ДНК (обычно получаемые с помощью фосфоимаджера, если фрагменты ДНК радиоактивно помечены). Файлы изображений должны иметь достаточно хорошее разрешение, чтобы в интересующей области расстояние между полосами было больше 10 пикселей. Формат файла изображения должен быть одним из тех, которые может читать ImageJ как таковой или через плагин BioFormats.
    \textbullet \ (Необязательно) 3D-атомистические структуры или молекулярные модели исследуемого комплекса ДНК-белок.
    
 
    \subsubsection{Скачивание примеров}

    Пакет HYDROID поставляется с набором примеров (шаблонов протоколов), доступных по ссылке \url{https://github.com/ncbi/HYDROID/tree/master/examples}. 
    
    \subsection{Описание протокола}
    
    ВАЖНО Перед выполнением процедуры убедитесь, что HYDROID и сопутствующие программные инструменты установлены.
    
    \subsubsection{Количественная оценка изображений HRF ПААГЭ (конвейер и библиотека HYDROIDexp)}
    
    
    
    1. \emph{Извлечение профилей полос из файлов изображений ПААГЭ и подготовка файлов данных для HYDROID.} Чтобы извлечь профиль полосы из изображения используйте программное обеспечение ImageJ.  Сохраните файл изображения с линиями, обозначающими диапазоны извлеченных данных, для дальнейшего использования.
    
    2. Загрузите образцы проектов анализа HRF, поставляемые с HYDROID.  Если ДНК в экспериментах с HRF была помечена на 3$^\prime$-конце, используйте пример 1; если ДНК в экспериментах с HRF была помечена на 5$^\prime$-конце, используйте пример 2. Папка примера проекта содержит сценарии Python для каждого этапа конвейера и папку данных с несколькими файлами данных, которые будут использоваться на следующих этапах.
    
    3. Замените файл \textsc{data/lane\_profiles.xls} файлом данных профилей полос, извлеченным из изображения ПААГЭ на шаге 1.
    
    4. Измените файл \textsc{data/lane\_config.csv}, чтобы указать, какие столбцы из файла \textsc{data/lane\_profiles.xls}  следует анализировать HYDROID, и укажите понятные человеку идентификаторы. На этом этапе для всех остальных параметров должно быть установлено значение NaN (используйте верхнюю строку исходного файла в качестве шаблона).

    5. Укажите исследуемую последовательность ДНК в файле \textsc{data/DNA\_seq.fasta}. 
    
    

    
    
    6. \emph{Определение положений пиков (местоположений электрофоретических полос) на профилях дорожек геля с помощью полуавтоматического интерактивного алгоритма.} Откройте сценарий \textsc{exp\_s2\_assign\_peaks.py}  в текстовом редакторе и измените переменную lane\_names (в строках 37–38), чтобы включить в нее имена полос из файла \textsc{data/lane\_config.csv} , которые следует проанализировать.

\emph{ВАЖНО:} Идентификация положений пиков в конечном итоге требуется только для дорожек с данными HRF, но ее можно использовать для изучения профилей дорожек секвенирования ДНК с помощью той же процедуры.

    7. Запустите сценарий с помощью следующей команды в терминале:
    \textsc{> Python exp\_s2\_assign\_peaks.py}
    Для каждой дорожки, указанной в Шаге 6, откроется интерактивное окно, показывающее график профиля дорожки и позволяющее настроить параметры алгоритма идентификации пиков, а также ряд дополнительных параметров.

    ВАЖНЫЙ ШАГ: Интерактивные окна открываются одно за другим. Пожалуйста, закройте каждое окно, чтобы перейти к следующему.
    
    8. Цели следующих шагов - указать диапазон данных для анализа и выделить каждый пик (полосу) в этом диапазоне звездочкой. Используйте интерактивные ползунки, чтобы указать диапазон значений профиля HRF, который будет анализироваться в дальнейшем (параметры \textsc{leftlim} и \textsc{rightlim}).

    9. Настройте \textsc{пиковый порог} (регулирует чувствительность алгоритма к величине пиков), \textsc{min\_dist\_left} (регулирует минимально допустимое расстояние между пиками в левой части диапазона данных), \textsc{min\_dist\_right} (регулирует минимально допустимое расстояние между пиками справа от диапазона данных), \textsc{baseline} (вычитает линейную базовую линию из данных перед попыткой идентифицировать пики) и \textsc{Segments} (устанавливает количество сегментов для разделения диапазона данных для интерполяции минимально необходимого расстояния между пиками) до тех пор, пока каждый пик (диапазон) не будет выделен только одной звездочкой.
        ВАЖНЫЙ ШАГ: В пределах анализируемого диапазона данных каждое местоположение полосы должно быть выделено только одной звездочкой. В противном случае последующий анализ будет некорректным.
        КРИТИЧЕСКИЙ ШАГ: Иногда интенсивность полос очень мала, данные зашумлены или полосы подходят так близко друг к другу, что на профиле полосы не видно локальных максимумов, представляющих полосу. Алгоритм деконволюции может работать хорошо в таких случаях, если ожидаемое положение полосы отмечено звездочкой. Последнее может быть достигнуто путем включения переключателя \textsc{Interpolate} в интерактивном окне. Алгоритм попытается угадать положения полос, которые не представлены определенным пиком на профиле HRF. Кроме того, положение полос можно указать вручную в файле \textsc{data/lane\_config.csv}. Для этого их местоположение можно ввести в столбец \textsc{addpeaks} файла.
    
    10. (Необязательно) Параметр \textsc{alignpos} позволяет указать положение любого пика, который будет использоваться на следующем этапе для выравнивания профиля HRF с профилями секвенирования ДНК для задания последовательности ДНК. Обычно это может быть заметный пик на конце геля, который однозначно идентифицируется как полоса, представляющая продукт ДНК одинаковой длины на дорожках HRF и секвенирования ДНК.

    11. Нажмите кнопку Сохранить. Данные будут записаны в файл \textsc{data/lane\_config.csv}. Повторите процедуру для других профилей полос.
    

    12.     \emph{Задание последовательности ДНК на профиле дорожки HRF.}  Откройте сценарий \textsc{exp\_s3\_call\_peaks.py} в текстовом редакторе и измените список \textsc{lane\_sets}, включив в него имена дорожек HRF (\textsc{footprinting\_profile}) вместе с именами соответствующих профилей секвенирования ДНК (\textsc{helper\_profiles}) из файла \textsc{data/lane\_config.csv}.

    КРИТИЧНЫЙ ШАГ: Обязательно укажите правильный конец маркировки ДНК в переменной \textsc{метки} (начиная со строки 35). Убедитесь, что последовательность ДНК, предоставленная для каждого профиля дорожки HRF (переменная \textsc{seq}), соответствует конкретной последовательности ДНК цепи ДНК, которая использовалась в эксперименте (записана в обозначениях 5 $^\prime$-> 3$^\prime$).
    
    13. Запустите сценарий с помощью следующей команды:
    \textsc{> Python exp\_s3\_call\_peaks.py}
    Для каждого профиля дорожки HRF, указанного на шаге 12, откроется интерактивное окно, где он будет нанесен на график вместе с соответствующими профилями секвенирования ДНК. Также будет показана последовательность исследуемой цепи ДНК.

    14. Цель следующих шагов 14-17 состоит в том, чтобы вручную сопоставить любой пик на профиле HRF с соответствующим положением в последовательности ДНК, просматривая профили секвенирования ДНК, нанесенные на тот же график. При необходимости используйте ползунки \textsc{alignpos}, чтобы выровнять профили секвенирования ДНК друг с другом и профилем HRF.
    
    15. Используйте ползунок \textsc{последовательности}, чтобы выбрать позицию в последовательности ДНК (выбранная позиция будет выделена заглавной буквой).

    16. Используйте ползунок \textsc{seqpeak}, чтобы навести стрелку на пик профиля дорожки HRF, соответствующий положению в последовательности ДНК, идентифицированной на предыдущем шаге.
    
  КРИТИЧЕСКИЙ ШАГ: Пользователь должен понимать природу выбранной реакции секвенирования ДНК и ее продуктов, чтобы правильно выполнить этот шаг (см. Дизайн эксперимента).

    17. Нажмите кнопку Сохранить. Данные будут записаны в файл \textsc{data/lane\_config.csv}. Повторите процедуру для других профилей дорожек HRF.


    
    
    
    18.     \emph{Подбор модели к профилю дорожки HRF для количественной оценки частот расщепления ДНК.} Откройте скрипт \textsc{exp\_s4\_fit\_model.py} в текстовом редакторе и измените список \textsc{lane\_data}, включив в него имена дорожек HRF, которые будут подвергаться количественной оценке. Параметры функции \textsc{fit\_peaks} также можно изменить для настройки результатов: для параметра \textsc{peaktype} можно задать значение Гаусса или Лоренца в зависимости от желаемой модели полосы, \textsc{Fit\_constraint} может принимать одно из значений, указанных в Таблице \ref{tab:p5_t2}, \textsc{maxfev} управляет максимальным количеством шагов оптимизации, установите меньшее количество, чтобы получить быстрые предварительные результаты.

    19. Запустите сценарий с помощью следующей команды:
    \textsc{> Python exp\_s4\_fit\_model.py}

    20. Скрипт выведет интерактивные графические окна с графиками результатов подгонки (Рисунок \ref{fig:p5_1_f3}Б). Результаты будут автоматически сохранены в CSV-файл, указанный в скрипте (\textsc{results/LANE\_NAME\_fitted\_intensities.csv}). Скрипт будет запускаться последовательно для всех профилей дорожек.
    ВАЖНЫЙ ШАГ. Пользователь должен изучить полученные графики (при необходимости увеличить масштаб, используя кнопку масштабирования) и убедиться, что в результатах подгонки нет отклонений, подобных тем, которые показаны на верхних панелях рисунков \ref{fig:p5_1_f3}Б, \ref{fig:p5_1_f3}В. 
    


    21.     \emph{Построение графика частоты расщепления вдоль последовательности ДНК.}
        HYDROID предоставляет настраиваемую функцию \textsc{plot\_prof\_on\_seq}, которую можно использовать для построения графиков профилей данных поверх последовательности ДНК (рисунок \ref{fig:p5_1_f4}). Откройте сценарий \textsc{exp\_s5\_plot\_cl\_freq.py} в текстовом редакторе и измените список \textsc{lane\_data} (рядом со строкой 28), включив в него имена файлов, содержащих результаты количественной оценки из шага 20. Также можно указать заголовок графика и имя выходного файла (строки 40-43).

    22. Запустите сценарий с помощью следующей команды:
        \textsc{> python exp\_s5\_plot\_cl\_freq.py}
        Откроются интерактивные окна с графиками, и графики будут сохранены в \textsc{results/LANE\_NAME\_fitted\_intensities.png}.
    
    \subsubsection{Прогнозирование интенсивности расщепления на основе атомистических трехмерных структур (конвейер и библиотека HYDROIDpred).}
    
    23.     \emph{Подготовка файла PDB с трехмерной структурой комплекса ДНК-белок}. Файл PDB, представляющий вашу экспериментальную систему, может быть доступен в базе данных PDB (www.pdb.org) или быть продуктом молекулярного моделирования. Поскольку в структурах PDB, полученных с помощью рентгеновских лучей, часто отсутствуют атомы водорода, вы можете использовать следующую команду для добавления атомов водорода:
    \textsc{> reduce -NUClear file.pdb> file\_H.pdb}
    где file.pdb - это имя исходного файла PDB.
    
    
    Полученный PDB-файл должен быть сохранен в подкаталоге \textsc{data/structure}.

    
    
    
    24. \emph{Запустите расчеты SASA, чтобы оценить профили частоты расщепления ДНК.} Откройте скрипт \textsc{pred\_s2\_calc\_H-SASA.py} в текстовом редакторе и измените список \textsc{prof\_data}, включив в него имя (имена) файла(ов) структуры PDB, идентификатор PDB цепи, которая представляет рассматриваемую нить ДНК, остатки. Параметр должен указывать диапазон номеров остатков из PDB-файла, который будет анализироваться, параметр \textsc{seq} должен указывать последовательность ДНК исследуемой цепи. Параметр \textsc{Hcontrib}  представляет собой список из семи чисел, который определяет вес вклада каждого отдельного атома водорода дезоксирибозы в следующем порядке [H1' H2' H2'' H3' H4'H5' H5'']. Для рентгеновских структур с низким и средним разрешением (выше 2,5-3\AA) предлагается учитывать только вклады атомов H4', H5' и H5''.

    25. Запустите сценарий с помощью следующей команды:
            \textsc{> python pred\_s2\_calc\_H-SASA.py}
        Предполагаемые профили расщепления ДНК будут сохранены в файлах CSV \textsc{results/PROF\_NAME\_H-SASA.csv}, где PROF\_NAME - имя, указанное ранее в списке \textsc{prof\_data}.


    26. \emph{Построение расчетных частот расщепления ДНК вдоль последовательности ДНК} Откройте сценарий \textsc{pred\_s3\_plot\_H-SASA.py} в текстовом редакторе и измените список \textsc{lane\_data}, включив в него имя файла CSV с предполагаемым профилем, последовательность ДНК исследуемой цепи и имя выходного файла.
    
    27. Запустите сценарий с помощью следующей команды:
            \textsc{> python pred\_s3\_plot\_H-SASA.py}
        Откроются интерактивные окна с графиками, дополнительно графики будут сохранены в виде файлов PNG.

    
    \subsubsection{Сравнение данных, полученных из конвейеров HYDROIDexp и HYDROIDprep}
    
    28. Данные из файлов CSV, полученные на этапах 20 (экспериментальные профили) и 27 (теоретические профили), можно открыть, нанести на график и сравнить с помощью любого программного обеспечения для построения графиков, предпочитаемого пользователем (например, MS Excel). CSV-файл, созданный конвейером HYDROIDexp (см., Например, \textsc{results/scCSE4\_601TA\_BS\_fitted\_intensities.csv} в примере 1), имеет столбцы с именами \textit{Site} и \textit{Intensity}, соответствующие положению последовательности ДНК и количественной оценке интенсивности/частоты расщепления ДНК, соответственно. CSV-файл, созданный конвейером HYDROIDpred (см., Например, \textsc{results/scCSE4\_601TA\_BS\_H-SASA.csv} в примере 1), имеет столбцы с именами \textit{Site} и \textit{H-SASA}, соответствующие положению последовательности ДНК и теоретически оцененной вероятности расщепления ДНК, соответственно.
    Для тех, кто обладает продвинутыми навыками в языке Python, мы предоставляем примеры для обработки и построения результатов примера 1 в файле \textsc{com\_plot\_ex\_vs\_pred.py}.
    
    \subsubsection{Временные затраты}

    Время, необходимое для протокола, зависит от количества экспериментальных образцов для анализа и знакомства пользователя с инструментами командной строки и языком сценариев Python. Оценки для изображения ПААГЭ геля с двумя дорожками HRF и четырьмя дорожками секвенирования ДНК на основе Примера 1 представлены ниже:

    Шаг 1. Обработка файла изображения с помощью Fiji ImageJ: 30 мин.

    Шаги 2-11, Определение положения пиков (расположение электрофоретических полос): 30 мин.

    Шаги 12-17, определение последовательности ДНК на профиле дорожки HRF: 30 мин.

    Шаги 18-20, Подгонка модели к профилю дорожки HRF: 30 мин.

    Шаги 21-22, извлечение и нанесение на график частот расщепления вдоль последовательности ДНК: 10 мин.

    Шаг 23. Подготовка файла PDB с трехмерной структурой комплекса ДНК-белок: 15 мин.

    Шаги 24-25, Настройка и выполнение расчетов SASA для оценки профилей частоты расщепления ДНК: 20 мин.

    Шаги 26-27, нанесение на график расчетных частот расщепления ДНК вдоль последовательности ДНК: 5 мин.
    
% \begin{table}[h!]
%     \centering
%     \begin{tabularx}{\textwidth}{|X|X|X|X|}
%         Шаги & Проблема & Возможная причина & Решение \\
%          \hline
%         Шаг 1 & В Fiji ImageJ изображение геля отображается в негативных цветах. & Таблица поиска настроена неправильно. & Нажмите Изображение-> Таблицы поиска-> Инвертировать LUT \\
%          \hline
%         Шаг 9 & Полуавтоматический алгоритм не может определить все необходимые местоположения диапазонов в профиле HRF. & Данные слишком зашумлены или величина пиков очень мала. & 1) Попробуйте настроить параметры так, чтобы четко идентифицировались только хорошо разрешенные пики. Нажмите на переключатель Interpolate, чтобы угадать недостающие позиции.
% 2) Если предыдущий вариант не решает проблему: запишите позиции полос, которые все еще отсутствуют, поместив указатель мыши в эти места. См. Инструкцию в файле \textsc{lane\_config.csv}  о том, как указать эти местоположения вручную в столбце \textsc{addpeaks}.\\
%          \hline
%         Шаг 20 & На полученном графике отдельные гауссианы, описывающие полосы на конце геля, слишком широки, чтобы представлять физически правдоподобное решение. & Произошла переобучение. & Используйте более строгий параметр ограничения подгонки, например, ``SIGMA=k*D+b''. \\
%          \hline
%         Шаг 27 & Теоретические профили расщепления ДНК выглядят шумно & Небольшие неровности трехмерной структуры могут повлиять на доступность атома водорода дезоксирибозы. & Используйте только вклады атомов водорода дезоксирибозы H4$^\prime$, H5$^\prime$ и H5$^\prime$$^\prime$ для оценки профиля расщепления. Установите для параметра \textsc{Hcontrib} значение $[0,0,0,0,1,1,1]$ \\
%          \hline
%     \end{tabularx}
%     \caption{Таблица поиска и устранения неисправностей.}
%     \label{tab:p5_ttrouble}
% \end{table}
    
    \subsection{Ожидаемые результаты}
    
    \subsubsection{Пример из практики: ДНК-белковые взаимодействия в нуклеосомах}
    
    В качестве примера применения HYDROID к системам ДНК-белок мы проанализировали и интерпретировали эксперименты HRF для нескольких нуклеосом, поскольку они представляют собой одну из самых сложных систем для изучения и демонстрируют периодические взаимодействия ДНК-белок. Были получены два независимых набора экспериментальных данных из разных лабораторий: а) HRF нуклеосом, восстановленных на 601 хорошо позиционирующей последовательности \cite{lowary_new_1998} с использованием гистонов из эритроцитов \textit{G. gallus}, б) HRF нуклеосом, восстановленных на аналогичной хорошо позиционирующей последовательности 601TA \cite{cloutier_dna_2005} с использованием рекомбинантных гистонов центромерных нуклеосом \textit{S. cerevisiae} \cite{shaytan_hydroxyl-radical_2017}. В двух независимых наборах данных также использовались разные методы маркировки ДНК: в первом случае был помечен 5$^\prime$-конец, а во втором - 3$^\prime$-конец.
    
    Результаты анализа этих экспериментов, а также сравнения с теоретическими профилями H-SASA представлены на рисунке \ref{fig:p5_1_f6}. Известно, что ДНК в нуклеосоме хорошо расположена в случае последовательности 601/601TA и намотана вокруг октамера гистона в сверхспиральной форме (рис. \ref{fig:p5_1_f6}А) интенсивности расщепления ДНК, как было ранее показано, очень похожи для верхней и нижней цепей из-за псевдосимметрии нуклеосомы \cite{shaytan_hydroxyl-radical_2017}. Профили расщепления ДНК отражают периодичность нуклеосомной ДНК 10-11 п.н., когда она вращается вокруг поверхности октамера гистонов (рис. \ref{fig:p5_1_f6}Б). Два экспериментальных профиля, полученные с использованием разной маркировки концов, хорошо совпадают, но отличаются в некоторых аспектах. Это может отражать воспроизводимость, которую можно ожидать от анализа HRF, выполненного с использованием различных протоколов. Ключевой характеристикой является положение минимумов и максимумов, в то время как точная величина расщепления ДНК может зависеть от экспериментальных условий, наличия частично собранных нуклеосомных состояний \cite{rychkov_partially_2017}, динамики ДНК и белков \cite{eslami-mossallam_nucleosome_2016}. Положения минимумов и максимумов совпадают с точностью до 1 нуклеотида между профилями (Рисунок \ref{fig:p5_1_f6}Б). Для ДНК, меченной 3$^\prime$-концом, в большинстве случаев минимумы смещены на одну пару оснований в сторону 5$^\prime$-конца ДНК по сравнению с экспериментом с ДНК, меченной по 5$^\prime$-концу. Возможное объяснение этой тонкой разницы заключается в том, что во время расщепления гидроксильных радикалов помимо основных продуктов с концевыми 5$^\prime$- и 3$^\prime$-фосфатами образуются другие второстепенные продукты. В частности, на 5$^\prime$-конце может быть образована цепь, оканчивающаяся 5$^\prime$-альдегидной группой \cite{balasubramanian_dna_1998}. Она на один нуклеотид длиннее цепи с 5'-фосфатным концом, в ней отсутствует отрицательный заряд фосфатной группы и его подвижность в геле на 2–3 нуклеотида ниже, чем у обычного продукта \cite{kappen_deoxyribonucleic_1983}. На 3$^\prime$-конце сайта расщепления второстепенным продуктом является 3$^\prime$-фосфогликолят, который, как известно, менее распространен и мигрирует близко к обычному продукту \cite{balasubramanian_dna_1998}. Таким образом, обычно рекомендуется мечение 5$^\prime$-конца ДНК.
    
    Пример сравнения теоретических профилей расщепления ДНК, извлеченных из структурной модели, и экспериментальных данных HRF показан на рисунке \ref{fig:p5_1_f6}В. Положения минимумов экспериментального и теоретического профилей совпадают с точностью до 1 нуклеотида. Форма теоретического профиля менее плавная, чем у экспериментального, что отражает ограничения теоретической модели. Более гладкая форма экспериментальных профилей, вероятно, связана с динамикой структур в растворе, а также с кинетическими эффектами, связанными с диффузией гидроксильных радикалов. Интерактивные веб-графики, сравнивающие профили H-SASA, полученные с разными параметрами, доступны в репозитории GitHub по ссылке \url{https://ncbi.github.io/HYDROID/examples/example1/results/nucl_H-SASAvsEXP_BS.html.} 
    
    
\begin{figure} [H]
    \centering
    \includegraphics[width=\textwidth]{images/p5/part5_1_np/p5_1_f4.pdf}
    \caption[Профили частоты расщепления ДНК, извлеченные из экспериментов по гидроксильному футпринтингу.]{\textbf{Профили частоты расщепления ДНК, извлеченные из экспериментов по гидроксильному футпринтингу.} В соответствии с нашей методологией количественной оценки данных HRF кривая профиля полосы на рисунке \ref{fig:p5_1_f3}B была построена с помощью комбинации функций Гаусса. Области этих индивидуальных функций Гаусса представляют собой интенсивности отдельных полос и, следовательно, значения частоты расщепления ДНК. Эти количественные значения частоты расщепления ДНК представлены здесь как для аппроксимации с и без органичней на параметры модели. Соответствие между последовательностью ДНК и профилем HRF было идентифицировано с использованием продуктов реакций секвенирования Максама-Гилберта. Видны отклонения в значениях, полученные в результате аппроксимации без ограничений на параметры модели.}
    \label{fig:p5_1_f4}
\end{figure}
    
\begin{figure} [H]
    \centering
    \includegraphics[width=\textwidth]{images/p5/part5_1_np/p5_1_f5.pdf}
    \caption[Профили H-SASA для ДНК в нуклеосомах]{Профили H-SASA для ДНК в нуклеосомах. A) Профили H-SASA (доступная для растворителя площадь поверхности атомов водорода дезоксирибозы) рассчитываются с использованием вкладов различных атомов водорода дезоксирибозы для каждого нуклеотида вдоль последовательности ДНК, начиная с центра нуклеосомы. Профили были рассчитаны путем усреднения более 50 снимков из МД моделирования с интервалом в 1 нс. Б) Сравнение профилей H-SASA (на основе атомов H5$^\prime$, H5$^\prime$$^\prime$ и H4$^\prime$), рассчитанныt на основе рентгеновской структуры (с атомами водорода, добавленными через программу REDUCE) и траектории МД. Если доступны только атомы H5$^\prime$, H5$^\prime$$^\prime$ и H4$^\prime$, профили не сильно различаются, и для надежной оценки профиля можно использовать рентгеновские структуры.}
    \label{fig:p5_1_f5}
\end{figure}
    
\begin{figure} [H]
    \centering
    \includegraphics[width=\textwidth]{images/p5/part5_1_np/p5_1_f6.pdf}
    \caption[Экспериментальные и теоретические профили частоты расщепления ДНК гидроксильными радикалами в нуклеосомах]{\textbf{Экспериментальные и теоретические профили частоты расщепления ДНК гидроксильными радикалами в нуклеосомах.} A) Структура ДНК-белковых взаимодействий в нуклеосоме (из модели по гомологии нуклеосомы \textit{S. cerevisiae}, воссозданной на основе последовательности ДНК 601 на основе структуры PDB ID 3LZ0), показаны центральные 70 п.н. ДНК, гистоновые хвосты не показаны. ДНК демонстрирует периодический паттерн взаимодействий с октамером гистонов каждые 10-11 п.н. Б) Сравнение двух независимо полученных экспериментальных профилей для нуклеосом, восстановленных на последовательности ДНК 601/601TA, полученным в результате работы HYDROID. Профиль, ДНК меченной по 5'-концом, соответствует нуклеосомам, восстановленным на 601 позиционирующей последовательности с использованием гистонов из эритроцитов \textit{G. gallus} (эти данные доступны в HYDROID как Пример 2). 3'-меченный профиль соответствует нуклеосомам, воссозданным на аналогичной позиционирующей последовательности 601TA с использованием рекомбинантных гистонов центромерных нуклеосом \textit{S. cerevisiae} (эти данные доступны в HYDROID как Пример 1). Сравнение экспериментальных и H -SASA профилей для центромерной нуклеосомы \textit{S. cerevisiae}. Экспериментальный профиль такой же, как и профиль, у ДНК меченной по 5'-концу из панели B. Профиль H-SASA был получен с помощью HYDROIDpred с использованием модели  по гомологии центромерной нуклеосомы \textit{S. cerevisiae} на основе структруы PDB 3LZ0 (также доступной в примере 1).}
    \label{fig:p5_1_f6}
\end{figure}
    
    
    \subsection{Благодарности}

    Эта работа была поддержана программами внутренних исследований Национальной медицинской библиотеки и Национального института рака, Национальных институтов здоровья; Российским научным фондом [грант № 14-24-00031, договор № 14-24-00031-р] (разработка алгоритмов моделирования гелей и пакета HYDROID\_GUI); Медицинским институтом Говарда Хьюза Исследовательский кампус Джанелии и Университетом Джонса Хопкинса; Российско-американской программой сотрудничества в рамках программы приглашенных стипендиатов Национального института здоровья; грантами NIH  R01GM119398 и R21CA220151, R21DE025398 и P50DE019032. В этой работе использовались вычислительные ресурсы кластера NIH HPC Biowulf (http://hpc.nih.gov) и  вычислительные ресурсы центра высокопроизводительных вычислений МГУ им. М.В. Ломоносова.

    Мы благодарим Т. Туллиуса за ценные предложения, которые помогли сформулировать первоначальную идею этого исследования, Л. Заславского за обсуждения оптимальных алгоритмов аппроксимации данных и С. Миттернахта за изменения в программе FreeSASA.

    
% \begin{figure} [h!]
%     \centering
%     \includegraphics[width=\textwidth]{images/p5/part5_1_np/p5_1_f7.pdf}
%     \caption{}
%     \label{fig:p5_1_f7}
% \end{figure}
    
% \begin{figure} [h!]
%     \centering
%     \includegraphics[width=\textwidth]{images/p5/part5_1_np/p5_1_f8.pdf}
%     \caption{}
%     \label{fig:p5_1_f8}
% \end{figure}
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    